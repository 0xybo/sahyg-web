const path = require("path");

class Utils {
	root = process.cwd();
	regexp = {
		url: /^https?:\/\/[a-z0-9.-]+(?:\.[a-z0-9.-]+)+/i,
		// /^[a-z](?:[-a-z0-9\+\.])*:(?:\/\/(?:(?:%[0-9a-f][0-9a-f]|[-a-z0-9\._~!\$&'\(\)\*\+,;=:\xA0-\ufD7FF\ufF900-\ufFDCF\ufFDF0-\ufFFEF]|[\ufD800-\ufD83E\ufD840-\ufD87E\ufD880-\ufD8BE\ufD8C0-\ufD8FE\ufD900-\ufD93E\ufD940-\ufD97E\ufD980-\ufD9BE\ufD9C0-\ufD9FE\ufDA00-\ufDA3E\ufDA40-\ufDA7E\ufDA80-\ufDABE\ufDAC0-\ufDAFE\ufDB00-\ufDB3E\ufDB44-\ufDB7E][\ufDC00-\ufDFFF]|[\ufD83F\ufD87F\ufD8BF\ufD8FF\ufD93F\ufD97F\ufD9BF\ufD9FF\ufDA3F\ufDA7F\ufDABF\ufDAFF\ufDB3F\ufDB7F][\ufDC00-\ufDFFD])*@)?(?:\[(?:(?:(?:[0-9a-f]{1,4}:){6}(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])(?:\.(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])){3})|::(?:[0-9a-f]{1,4}:){5}(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])(?:\.(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])){3})|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])(?:\.(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])){3})|(?:[0-9a-f]{1,4}:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])(?:\.(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])){3})|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])(?:\.(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])){3})|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])(?:\.(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])){3})|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])(?:\.(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])){3})|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|v[0-9a-f]+[-a-z0-9\._~!\$&'\(\)\*\+,;=:]+)\]|(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])(?:\.(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])){3}|(?:%[0-9a-f][0-9a-f]|[-a-z0-9\._~!\$&'\(\)\*\+,;=@\xA0-\ufD7FF\ufF900-\ufFDCF\ufFDF0-\ufFFEF]|[\ufD800-\ufD83E\ufD840-\ufD87E\ufD880-\ufD8BE\ufD8C0-\ufD8FE\ufD900-\ufD93E\ufD940-\ufD97E\ufD980-\ufD9BE\ufD9C0-\ufD9FE\ufDA00-\ufDA3E\ufDA40-\ufDA7E\ufDA80-\ufDABE\ufDAC0-\ufDAFE\ufDB00-\ufDB3E\ufDB44-\ufDB7E][\ufDC00-\ufDFFF]|[\ufD83F\ufD87F\ufD8BF\ufD8FF\ufD93F\ufD97F\ufD9BF\ufD9FF\ufDA3F\ufDA7F\ufDABF\ufDAFF\ufDB3F\ufDB7F][\ufDC00-\ufDFFD])*)(?::[0-9]*)?(?:\/(?:(?:%[0-9a-f][0-9a-f]|[-a-z0-9\._~!\$&'\(\)\*\+,;=:@\xA0-\ufD7FF\ufF900-\ufFDCF\ufFDF0-\ufFFEF]|[\ufD800-\ufD83E\ufD840-\ufD87E\ufD880-\ufD8BE\ufD8C0-\ufD8FE\ufD900-\ufD93E\ufD940-\ufD97E\ufD980-\ufD9BE\ufD9C0-\ufD9FE\ufDA00-\ufDA3E\ufDA40-\ufDA7E\ufDA80-\ufDABE\ufDAC0-\ufDAFE\ufDB00-\ufDB3E\ufDB44-\ufDB7E][\ufDC00-\ufDFFF]|[\ufD83F\ufD87F\ufD8BF\ufD8FF\ufD93F\ufD97F\ufD9BF\ufD9FF\ufDA3F\ufDA7F\ufDABF\ufDAFF\ufDB3F\ufDB7F][\ufDC00-\ufDFFD]))*)*|\/(?:(?:(?:(?:%[0-9a-f][0-9a-f]|[-a-z0-9\._~!\$&'\(\)\*\+,;=:@\xA0-\ufD7FF\ufF900-\ufFDCF\ufFDF0-\ufFFEF]|[\ufD800-\ufD83E\ufD840-\ufD87E\ufD880-\ufD8BE\ufD8C0-\ufD8FE\ufD900-\ufD93E\ufD940-\ufD97E\ufD980-\ufD9BE\ufD9C0-\ufD9FE\ufDA00-\ufDA3E\ufDA40-\ufDA7E\ufDA80-\ufDABE\ufDAC0-\ufDAFE\ufDB00-\ufDB3E\ufDB44-\ufDB7E][\ufDC00-\ufDFFF]|[\ufD83F\ufD87F\ufD8BF\ufD8FF\ufD93F\ufD97F\ufD9BF\ufD9FF\ufDA3F\ufDA7F\ufDABF\ufDAFF\ufDB3F\ufDB7F][\ufDC00-\ufDFFD]))+)(?:\/(?:(?:%[0-9a-f][0-9a-f]|[-a-z0-9\._~!\$&'\(\)\*\+,;=:@\xA0-\ufD7FF\ufF900-\ufFDCF\ufFDF0-\ufFFEF]|[\ufD800-\ufD83E\ufD840-\ufD87E\ufD880-\ufD8BE\ufD8C0-\ufD8FE\ufD900-\ufD93E\ufD940-\ufD97E\ufD980-\ufD9BE\ufD9C0-\ufD9FE\ufDA00-\ufDA3E\ufDA40-\ufDA7E\ufDA80-\ufDABE\ufDAC0-\ufDAFE\ufDB00-\ufDB3E\ufDB44-\ufDB7E][\ufDC00-\ufDFFF]|[\ufD83F\ufD87F\ufD8BF\ufD8FF\ufD93F\ufD97F\ufD9BF\ufD9FF\ufDA3F\ufDA7F\ufDABF\ufDAFF\ufDB3F\ufDB7F][\ufDC00-\ufDFFD]))*)*)?|(?:(?:(?:%[0-9a-f][0-9a-f]|[-a-z0-9\._~!\$&'\(\)\*\+,;=:@\xA0-\ufD7FF\ufF900-\ufFDCF\ufFDF0-\ufFFEF]|[\ufD800-\ufD83E\ufD840-\ufD87E\ufD880-\ufD8BE\ufD8C0-\ufD8FE\ufD900-\ufD93E\ufD940-\ufD97E\ufD980-\ufD9BE\ufD9C0-\ufD9FE\ufDA00-\ufDA3E\ufDA40-\ufDA7E\ufDA80-\ufDABE\ufDAC0-\ufDAFE\ufDB00-\ufDB3E\ufDB44-\ufDB7E][\ufDC00-\ufDFFF]|[\ufD83F\ufD87F\ufD8BF\ufD8FF\ufD93F\ufD97F\ufD9BF\ufD9FF\ufDA3F\ufDA7F\ufDABF\ufDAFF\ufDB3F\ufDB7F][\ufDC00-\ufDFFD]))+)(?:\/(?:(?:%[0-9a-f][0-9a-f]|[-a-z0-9\._~!\$&'\(\)\*\+,;=:@\xA0-\ufD7FF\ufF900-\ufFDCF\ufFDF0-\ufFFEF]|[\ufD800-\ufD83E\ufD840-\ufD87E\ufD880-\ufD8BE\ufD8C0-\ufD8FE\ufD900-\ufD93E\ufD940-\ufD97E\ufD980-\ufD9BE\ufD9C0-\ufD9FE\ufDA00-\ufDA3E\ufDA40-\ufDA7E\ufDA80-\ufDABE\ufDAC0-\ufDAFE\ufDB00-\ufDB3E\ufDB44-\ufDB7E][\ufDC00-\ufDFFF]|[\ufD83F\ufD87F\ufD8BF\ufD8FF\ufD93F\ufD97F\ufD9BF\ufD9FF\ufDA3F\ufDA7F\ufDABF\ufDAFF\ufDB3F\ufDB7F][\ufDC00-\ufDFFD]))*)*|(?!(?:%[0-9a-f][0-9a-f]|[-a-z0-9\._~!\$&'\(\)\*\+,;=:@\xA0-\ufD7FF\ufF900-\ufFDCF\ufFDF0-\ufFFEF]|[\ufD800-\ufD83E\ufD840-\ufD87E\ufD880-\ufD8BE\ufD8C0-\ufD8FE\ufD900-\ufD93E\ufD940-\ufD97E\ufD980-\ufD9BE\ufD9C0-\ufD9FE\ufDA00-\ufDA3E\ufDA40-\ufDA7E\ufDA80-\ufDABE\ufDAC0-\ufDAFE\ufDB00-\ufDB3E\ufDB44-\ufDB7E][\ufDC00-\ufDFFF]|[\ufD83F\ufD87F\ufD8BF\ufD8FF\ufD93F\ufD97F\ufD9BF\ufD9FF\ufDA3F\ufDA7F\ufDABF\ufDAFF\ufDB3F\ufDB7F][\ufDC00-\ufDFFD])))(?:\?(?:%[0-9a-f][0-9a-f]|[-a-z0-9\._~!\$&'\(\)\*\+,;=:@\/\?\xA0-\ufD7FF\ufE000-\ufFDCF\ufFDF0-\ufFFEF]|[\ufD800-\ufD83E\ufD840-\ufD87E\ufD880-\ufD8BE\ufD8C0-\ufD8FE\ufD900-\ufD93E\ufD940-\ufD97E\ufD980-\ufD9BE\ufD9C0-\ufD9FE\ufDA00-\ufDA3E\ufDA40-\ufDA7E\ufDA80-\ufDABE\ufDAC0-\ufDAFE\ufDB00-\ufDB3E\ufDB44-\ufDB7E\ufDB80-\ufDBBE\ufDBC0-\ufDBFE][\ufDC00-\ufDFFF]|[\ufD83F\ufD87F\ufD8BF\ufD8FF\ufD93F\ufD97F\ufD9BF\ufD9FF\ufDA3F\ufDA7F\ufDABF\ufDAFF\ufDB3F\ufDB7F\ufDBBF\ufDBFF][\ufDC00-\ufDFFD])*)?(?:\#(?:%[0-9a-f][0-9a-f]|[-a-z0-9\._~!\$&'\(\)\*\+,;=:@\/\?\xA0-\ufD7FF\ufF900-\ufFDCF\ufFDF0-\ufFFEF]|[\ufD800-\ufD83E\ufD840-\ufD87E\ufD880-\ufD8BE\ufD8C0-\ufD8FE\ufD900-\ufD93E\ufD940-\ufD97E\ufD980-\ufD9BE\ufD9C0-\ufD9FE\ufDA00-\ufDA3E\ufDA40-\ufDA7E\ufDA80-\ufDABE\ufDAC0-\ufDAFE\ufDB00-\ufDB3E\ufDB44-\ufDB7E][\ufDC00-\ufDFFF]|[\ufD83F\ufD87F\ufD8BF\ufD8FF\ufD93F\ufD97F\ufD9BF\ufD9FF\ufDA3F\ufDA7F\ufDABF\ufDAFF\ufDB3F\ufDB7F][\ufDC00-\ufDFFD])*)?$/i;
		email: /(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/i,
		password:
			/^(?=(?:[^A-Z]*[A-Z])+(?![^A-Z]*[A-Z]))(?=(?:[^a-z]*[a-z])+(?![^a-z]*[a-z]))(?=(?:[^0-9]*[0-9])+(?![^0-9]*[0-9]))(?=(?:[^!"#\$%&'\(\)\*\+,-\.\/:;<=>\?@[\]\^_`\{\|}~]*[!"#\$%&'\(\)\*\+,-\.\/:;<=>\?@[\]\^_`\{\|}~])+(?![^!"#\$%&'\(\)\*\+,-\.\/:;<=>\?@[\]\^_`\{\|}~]*[!"#\$%&'\(\)\*\+,-\.\/:;<=>\?@[\]\^_`\{\|}~]))[A-Za-z0-9!"#\$%&'\(\)\*\+,-\.\/:;<=>\?@[\]\^_`\{\|}~]{8,}$/,
	};

	relativeToRoot(absolutePath) {
		return path.relative(this.root, absolutePath);
	}
	parseCookies(text) {
		let cookies = {};
		text?.split(";").forEach((e) => {
			let [key, value] = e.trim().split("=");
			cookies[key] = value;
		});
		return cookies;
	}
	isUrl(url) {
		return this.regexp.url.test(url);
	}
	isEmail(email) {
		return this.regexp.email.test(email.toString());
	}
	isValidPassword(password) {
		return this.regexp.password.test(password);
	}
}

module.exports = Utils;
